<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Configuration</title>
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <center><h3>Password Configuration</h3></center>
    <div id="passwordConfig">
        <p><strong>Current Password:</strong> <span id="currentPassword"></span></p>
        <label for="newPassword">New Password:</label>
        <input type="password" id="newPassword" name="newPassword"><br><br>
        <button onclick="changePassword()">Change Password</button>
        <button onclick="revertToDefault()">Revert to Default</button>
    </div>

    <script>
        const fs = require('fs');
        const defaultConfig = [{ "DesktopIconSize": "40px", "LoginPassword": "admin" }];

        // Function to load and display the current password
        function loadPassword() {
            fs.readFile('/path/to/config.json', 'utf8', (err, data) => {
                if (err) {
                    console.error(err);
                    return;
                }
                const config = JSON.parse(data);
                document.getElementById('currentPassword').innerText = config[0].LoginPassword;
            });
        }

        // Function to change the password
        function changePassword() {
            const newPassword = document.getElementById('newPassword').value;
            fs.readFile('../config.json', 'utf8', (err, data) => {
                if (err) {
                    console.error(err);
                    return;
                }
                const config = JSON.parse(data);
                config[0].LoginPassword = newPassword;
                fs.writeFile('../config.json', JSON.stringify(config, null, 2), (err) => {
                    if (err) {
                        console.error(err);
                        return;
                    }
                    loadPassword();
                    alert('Password changed successfully!');
                });
            });
        }

        // Function to revert to default password
        function revertToDefault() {
            fs.writeFile('../config.json', JSON.stringify(defaultConfig, null, 2), (err) => {
                if (err) {
                    console.error(err);
                    return;
                }
                loadPassword();
                alert('Password reverted to default successfully!');
            });
        }

        // Load the current password when the page loads
        window.onload = loadPassword;
    </script>
</body>
</html>
